global:
  default_inherits: default

tools:
  default:
    cores: 2
    mem: cores * 3
    env:
      TEST_JOB_SLOTS: "{cores}"
    params:
      native_spec: "--mem {mem} --cores {cores}"
    scheduling:
      required: []
      preferred:
        - general
      tolerated:
      rejected:
        - pulsar
    rules:
      - match: input_size < 5
        fail: We don't run piddling datasets
  bwa:
    scheduling:
      required:
        - pulsar
    rules:
      - match: input_size <= 10
        cores: 4
        mem: cores * 4
      - match: input_size > 10 and input_size < 20
        scheduling:
          required:
            - highmem
      - match: input_size >= 20
        fail: Too much data, shouldn't run
users:
  fairycake@vortex.org:
    env:
      TEST_JOB_SLOTS_USER: "{cores*2}"
    params:
      native_spec_user: "--mem {mem} --cores {cores}"
    scheduling:
      required:
        - pulsar
  arthur@vortex.org:
    scheduling:
      required:
        - earth
    rules:
      - match: True
        cores: 6
        mem: cores * 6
      - match: input_size >= 5
        fail: Just because
  improbable@vortex.org:
    scheduling:
      required:
        - pulsar
      rejected:
        - pulsar
  .*@vortex.org:
    scheduling:
      required:
        - pulsar

destinations:
  local:
    cores: 4
    mem: 16
    scheduling:
      preferred:
        - general
  k8s_environment:
    cores: 16
    mem: 64
    gpus: 2
    scheduling:
      preferred:
        - pulsar
